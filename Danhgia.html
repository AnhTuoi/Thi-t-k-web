<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ÄÃ¡nh giÃ¡ mÃ³n Äƒn</title>

<style>
body{
  font-family: Arial;
  background:#f5f5f5;
  padding:20px;
}

.container{
  max-width:900px;
  margin:auto;
}

.card{
  background:white;
  padding:20px;
  margin-bottom:15px;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
}

button{
  padding:10px 18px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background:#ff6600;
  color:white;
}

textarea{
  width:100%;
  margin-top:10px;
  padding:8px;
}

/* STAR RATING */

.star-rating{
  display:flex;
  justify-content:center;
  gap:10px;
  font-size:40px;
  margin:15px 0;
  cursor:pointer;
}

.star{
  color:#ccc;
  transition:0.2s;
}

.star.active{
  color:#ff6600;
}

.star:hover{
  transform:scale(1.2);
}
</style>
</head>

<body>

<div class="container">

<h2>ğŸ›’ ÄÆ¡n hÃ ng cá»§a báº¡n</h2>
<div id="orderList"></div>

<button onclick="submitReviews()">Gá»­i Ä‘Ã¡nh giÃ¡</button>

</div>

<script>

// ================= BACKEND GIáº¢ Láº¬P =================
// Backend xá»­ lÃ½ duyá»‡t vÃ  lÆ°u dá»¯ liá»‡u (frontend khÃ´ng tháº¥y)

const fakeBackend = {

  database: [],

  submitReview(review){

    // logic duyá»‡t ná»™i bá»™
    if(review.rating >= 3){
      review.status = "approved";
    } else {
      review.status = "rejected";
    }

    // lÆ°u vÃ o database
    this.database.push(review);

    console.log("Database hiá»‡n táº¡i:", this.database);
  }

};


// ================= Dá»® LIá»†U ÄÆ N =================
const order = [
  {id:1, name:"Pizza Háº£i sáº£n"},
  {id:2, name:"GÃ  rÃ¡n"},
  {id:3, name:"TrÃ  sá»¯a"}
];

let selectedRatings = {};


// ================= RENDER ÄÆ N =================
function renderOrder(){

  const container = document.getElementById("orderList");
  container.innerHTML = "";

  order.forEach(item=>{
    container.innerHTML += `
      <div class="card">
        <h3>${item.name}</h3>

        <label>Chá»n sá»‘ sao:</label>

        <div class="star-rating" data-id="${item.id}">
          <span class="star" data-value="1">â˜…</span>
          <span class="star" data-value="2">â˜…</span>
          <span class="star" data-value="3">â˜…</span>
          <span class="star" data-value="4">â˜…</span>
          <span class="star" data-value="5">â˜…</span>
        </div>

        <textarea id="comment-${item.id}" placeholder="Nháº­n xÃ©t..."></textarea>
      </div>
    `;
  });

  setupStarRating();
}


// ================= CHá»ŒN SAO =================
function setupStarRating(){

  document.querySelectorAll(".star-rating").forEach(container=>{

    const foodId = container.dataset.id;
    const stars = container.querySelectorAll(".star");

    stars.forEach(star=>{
      star.addEventListener("click",()=>{

        const value = star.dataset.value;
        selectedRatings[foodId] = Number(value);

        stars.forEach(s=>s.classList.remove("active"));

        stars.forEach(s=>{
          if(s.dataset.value <= value){
            s.classList.add("active");
          }
        });

      });
    });

  });
}


// ================= Gá»¬I REVIEW =================
// frontend chá»‰ gá»­i dá»¯ liá»‡u
function submitReviews(){

  order.forEach(item=>{

    const rating = selectedRatings[item.id] || 0;
    const comment = document.getElementById(`comment-${item.id}`).value;

    if(comment.trim() !== "" && rating > 0){

      const review = {
        food:item.name,
        rating,
        comment,
        createdAt:new Date()
      };

      // gá»­i lÃªn backend (xá»­ lÃ½ + lÆ°u ná»™i bá»™)
      fakeBackend.submitReview(review);
    }
  });

  alert("ÄÃ£ gá»­i Ä‘Ã¡nh giÃ¡! Há»‡ thá»‘ng sáº½ xá»­ lÃ½ ná»™i bá»™.");
}


// ================= KHá»I Táº O =================
renderOrder();

</script>

</body>
</html>