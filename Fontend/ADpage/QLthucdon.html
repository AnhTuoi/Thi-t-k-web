<!DOCTYPE html>
<html class="light" lang="vi">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Quản lý Món ăn Admin FoodGo</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f48c25",
                        "background-light": "#f8f7f5",
                        "sidebar-bg": "#ffffff",
                        "card-bg": "#ffffff",
                        "success": "#10b981",
                        "warning": "#f59e0b",
                        "danger": "#ef4444"
                    },
                    fontFamily: { "display": ["Plus Jakarta Sans", "sans-serif"] },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "3xl": "1.5rem", "full": "9999px" }
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        body { font-family: "Plus Jakarta Sans", sans-serif; }
        .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; }
        .active-menu { @apply bg-primary/10 text-primary border-r-4 border-primary; }
        .tab-active { @apply border-primary text-primary; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        #chatbot-window { display: none; }
        #chatbot-toggle:focus-within + #chatbot-window,
        #chatbot-window:hover,
        #chatbot-window:focus-within { display: flex; }
        .status-instock { @apply bg-green-100 text-green-700; }
        .status-outstock { @apply bg-red-100 text-red-700; }
    </style>
</head>
<body class="bg-background-light text-[#1c140d] min-h-screen flex">

<!-- Sidebar (kết hợp từ file gốc) -->
<aside class="w-64 bg-sidebar-bg border-r border-[#f4ede7] flex flex-col fixed h-full z-50">
<div class="p-6 flex items-center gap-2 text-primary shrink-0">
<span class="material-symbols-outlined text-4xl font-bold">fastfood</span>
<h2 class="text-xl font-black tracking-tighter">FoodGo <span class="text-[10px] bg-primary text-white px-1.5 py-0.5 rounded ml-1 uppercase">Admin</span></h2>
</div>
<nav class="flex-1 px-4 space-y-1 overflow-y-auto no-scrollbar">
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="Tongquan.html">
<span class="material-symbols-outlined">dashboard</span>
            Tổng quan
        </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold active-menu rounded-lg transition-all" href="QLthucdon.html">
<span class="material-symbols-outlined">restaurant_menu</span>
            Món ăn
        </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="QLdon.html">
<span class="material-symbols-outlined">receipt_long</span>
            Đơn hàng
        </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="QLnguoidung.html">
<span class="material-symbols-outlined">group</span>
            Người dùng
        </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="QLtaikhoan.html">
<span class="material-symbols-outlined">key</span>
                Tài khoản
            </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="QLkhuyenmai.html">
<span class="material-symbols-outlined">redeem</span>
                Khuyến mãi
            </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="QLdanhgia.html">
<span class="material-symbols-outlined">star</span>
                Đánh giá
            </a>
<div class="pt-4 mt-4 border-t border-[#f4ede7]">
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="TKrieng.html">
<span class="material-symbols-outlined">person</span>
                    Tài khoản của tôi
                </a>
<a class="flex items-center gap-3 px-4 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 hover:text-primary rounded-lg transition-all" href="Caidat.html">
<span class="material-symbols-outlined">settings</span>
                Cài đặt
            </a>
</div>
</nav>
<div class="p-4 border-t border-[#f4ede7]">
<div class="flex items-center gap-3 p-2 bg-[#f4ede7] rounded-2xl">
<div class="h-10 w-10 rounded-xl bg-cover bg-center border border-white" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCa-A_xiobVGkBwC98jkh3MfvIrJEVa75kurLiQOhyxLHiqGDmWSsVr_3YTAoQYZRPXRahwTNzZ-dbYqIqOHu7aoq0os0D0gWI2Hs1R73wlAgMKuVw6wQ-tOxile4ilTWsYrJeyspkP0VAn11Fjld90gLhccOvG5qah2fn0VZ8gg3bqja4zkLKIb04lGzuBtFVdm9JuODdXB16H5j2gDoRiGFOEUVv2Qa8kEbuzaZGy4kqLSkOeL060s65bgJBfG73sSlq7ro4ydPw");'></div>
<div class="overflow-hidden">
<p class="text-xs font-bold truncate">Admin FoodGo</p>
<p class="text-[10px] text-[#9c7349]">Quản trị viên</p>
</div>
</div>
</div>
</aside>

<main class="flex-1 ml-64 p-8">

<header class="mb-8">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h1 class="text-2xl font-black tracking-tight text-[#1c140d]">Quản lý món ăn</h1>
            <p class="text-sm text-[#9c7349]">Quản lý danh sách món, giá bán, tồn kho và hình ảnh</p>
        </div>
        <div class="flex items-center gap-3">
            <button id="exportBtn" class="flex items-center gap-2 px-6 py-2.5 bg-white border border-[#f4ede7] text-[#1c140d] text-sm font-bold rounded-xl hover:bg-gray-50 shadow-sm transition-all">
                <span class="material-symbols-outlined text-xl">download</span>
                Export dữ liệu
            </button>
            <button id="importBtn" class="flex items-center gap-2 px-6 py-2.5 bg-white border border-[#f4ede7] text-[#1c140d] text-sm font-bold rounded-xl hover:bg-gray-50 shadow-sm transition-all">
                <span class="material-symbols-outlined text-xl">upload</span>
                Import
            </button>
            <button id="addDishBtn" class="flex items-center gap-2 px-6 py-2.5 bg-primary text-white text-sm font-bold rounded-xl hover:bg-primary/90 shadow-lg shadow-primary/20 transition-all">
                <span class="material-symbols-outlined text-xl">add</span>
                Thêm món ăn
            </button>
        </div>
    </div>

    <div class="flex items-center justify-between border-b border-[#f4ede7]">
        <div class="flex gap-8">
            <button id="tabAll" class="pb-4 text-sm font-bold tab-active border-b-2 transition-all">Tất cả</button>
            <button id="tabInStock" class="pb-4 text-sm font-bold text-[#9c7349] hover:text-primary border-b-2 border-transparent transition-all">Còn hàng</button>
            <button id="tabOutStock" class="pb-4 text-sm font-bold text-[#9c7349] hover:text-primary border-b-2 border-transparent transition-all">Hết hàng</button>
            <button id="tabPizza" class="pb-4 text-sm font-bold text-[#9c7349] hover:text-primary border-b-2 border-transparent transition-all">Pizza</button>
            <button id="tabBurger" class="pb-4 text-sm font-bold text-[#9c7349] hover:text-primary border-b-2 border-transparent transition-all">Burger</button>
        </div>
        <div class="flex items-center gap-4 pb-4">
            <div class="relative">
                <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-[#9c7349]">
                    <span class="material-symbols-outlined text-xl">search</span>
                </span>
                <input id="searchInput" class="h-10 pl-10 pr-4 rounded-xl border-none bg-white shadow-sm text-sm w-64 focus:ring-2 focus:ring-primary/50 transition-all" placeholder="Tìm món ăn..." type="text"/>
            </div>
            <select id="sortSelect" class="h-10 px-4 rounded-xl border-none bg-white shadow-sm text-sm text-[#1c140d] focus:ring-2 focus:ring-primary/50 transition-all">
                <option value="newest">Mới nhất</option>
                <option value="oldest">Cũ nhất</option>
                <option value="name_asc">A → Z</option>
                <option value="name_desc">Z → A</option>
                <option value="price_asc">Giá tăng dần</option>
                <option value="price_desc">Giá giảm dần</option>
                <option value="stock_desc">Tồn kho cao → thấp</option>
            </select>
        </div>
    </div>
</header>

<!-- Modal thêm/sửa món ăn -->
<div id="dishModal" class="hidden fixed inset-0 bg-black/50 z-[999] flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
        <div class="bg-primary p-6 text-white flex items-center justify-between">
            <h3 class="text-lg font-black" id="modalTitle">Thêm món ăn mới</h3>
            <button id="closeDishModal" class="p-2 hover:bg-white/10 rounded-xl transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="p-6 overflow-y-auto max-h-[70vh]">
            <form id="dishForm">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishName">Tên món *</label>
                        <input id="dishName" type="text" required class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50"/>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishPrice">Giá bán (đ) *</label>
                        <input id="dishPrice" type="number" required class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50"/>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishCategory">Danh mục *</label>
                        <select id="dishCategory" required class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50">
                            <option value="Pizza">Pizza</option>
                            <option value="Burger">Burger</option>
                            <option value="Pasta">Pasta</option>
                            <option value="Drink">Đồ uống</option>
                            <option value="Dessert">Tráng miệng</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishUnit">Đơn vị tính *</label>
                        <input id="dishUnit" type="text" required value="Phần" class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50"/>
                    </div>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishStock">Tồn kho *</label>
                    <input id="dishStock" type="number" required min="0" class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50"/>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-bold text-[#1c140d] mb-2" for="dishImage">URL hình ảnh</label>
                    <input id="dishImage" type="url" class="h-12 w-full px-4 rounded-xl border border-[#f4ede7] focus:ring-2 focus:ring-primary/50"/>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-bold text-[#1c140d] mb-2">Mô tả ngắn</label>
                    <textarea id="dishDesc" class="h-24 w-full px-4 py-3 rounded-xl border border-[#f4ede7] resize-none focus:ring-2 focus:ring-primary/50"></textarea>
                </div>
                <div class="flex justify-end gap-3">
                    <button type="button" id="cancelDishBtn" class="px-6 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 rounded-xl">Hủy</button>
                    <button type="submit" class="px-6 py-3 bg-primary text-white text-sm font-bold rounded-xl hover:bg-primary/90">Lưu món ăn</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal xem chi tiết món -->
<div id="detailDishModal" class="hidden fixed inset-0 bg-black/50 z-[999] flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-hidden">
        <div class="bg-primary p-6 text-white flex items-center justify-between">
            <h3 class="text-lg font-black">Chi tiết món ăn</h3>
            <button id="closeDetailDish" class="p-2 hover:bg-white/10 rounded-xl transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="p-6 overflow-y-auto max-h-[70vh] grid grid-cols-3 gap-6">
            <div class="col-span-1">
                <div class="bg-gray-50 rounded-2xl p-6 text-center">
                    <div class="h-40 w-40 rounded-2xl bg-cover bg-center border-4 border-white mx-auto mb-4" id="detailDishImage"></div>
                    <h3 class="text-xl font-black text-[#1c140d]" id="detailDishName"></h3>
                    <p class="text-sm text-[#9c7349] mt-1" id="detailDishCategory"></p>
                    <div class="mt-4">
                        <span class="inline-block px-4 py-1 rounded-full text-sm font-bold" id="detailDishStatus"></span>
                    </div>
                </div>
            </div>
            <div class="col-span-2">
                <div class="grid grid-cols-2 gap-6">
                    <div class="bg-gray-50 rounded-2xl p-6">
                        <h4 class="text-sm font-bold text-[#9c7349] mb-4">Thông tin giá & tồn kho</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between"><span class="text-[#9c7349]">Giá bán:</span><span class="font-bold" id="detailDishPrice"></span></div>
                            <div class="flex justify-between"><span class="text-[#9c7349]">Đơn vị:</span><span class="font-bold" id="detailDishUnit"></span></div>
                            <div class="flex justify-between"><span class="text-[#9c7349]">Tồn kho hiện tại:</span><span class="font-bold" id="detailDishStock"></span></div>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-2xl p-6">
                        <h4 class="text-sm font-bold text-[#9c7349] mb-4">Thông tin khác</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between"><span class="text-[#9c7349]">Mã món:</span><span class="font-bold" id="detailDishId"></span></div>
                            <div class="flex justify-between"><span class="text-[#9c7349]">Ngày thêm:</span><span class="font-bold" id="detailDishAdded"></span></div>
                            <div class="flex justify-between"><span class="text-[#9c7349]">Mô tả:</span><span class="font-bold" id="detailDishDesc"></span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Import - Thiết kế giống ảnh chị gửi -->
<div id="importModal" class="hidden fixed inset-0 bg-black/50 z-[999] flex items-center justify-center p-4">
    <div class="bg-white rounded-3xl max-w-lg w-full overflow-hidden">
        <div class="bg-primary p-6 text-white flex items-center justify-between">
            <h3 class="text-lg font-black">Import dữ liệu món ăn</h3>
            <button id="closeImportModalBtn" class="p-2 hover:bg-white/10 rounded-xl transition-colors">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div class="p-6">
            <div class="border-2 border-dashed border-[#f4ede7] rounded-2xl p-10 text-center mb-6">
                <span class="material-symbols-outlined text-6xl text-primary mb-4">upload</span>
                <h4 class="font-bold text-[#1c140d] text-lg mb-2">Kéo thả file hoặc chọn từ máy tính</h4>
                <p class="text-sm text-[#9c7349] mb-6">Hỗ trợ file CSV, Excel (max 5MB)</p>
                <input type="file" id="importFileInput" class="hidden" accept=".csv,.xlsx,.xls"/>
                <button id="selectImportFileBtn" class="px-8 py-3 bg-primary text-white text-sm font-bold rounded-xl hover:bg-primary/90 transition-all">
                    Chọn file
                </button>
            </div>

            <div class="bg-blue-50 rounded-xl p-5 mb-6">
                <div class="flex items-start gap-3">
                    <span class="material-symbols-outlined text-blue-600 mt-1 text-xl">info</span>
                    <div>
                        <h5 class="text-sm font-bold text-blue-800 mb-2">Lưu ý khi import</h5>
                        <ul class="text-xs text-blue-700 space-y-1.5 list-disc pl-4">
                            <li>File CSV cần có các cột: Tên món, Giá bán, Danh mục, ĐVT, Tồn kho</li>
                            <li>Tên món và giá bán phải là duy nhất trong hệ thống</li>
                            <li>Danh mục: Pizza, Burger, Pasta, Drink, Dessert</li>
                            <li>Mẫu file có thể tải <a href="#" class="font-bold underline text-blue-800 hover:underline">tại đây</a></li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="flex justify-end gap-4">
                <button id="cancelImportBtn" class="px-8 py-3 text-sm font-bold text-[#9c7349] hover:bg-gray-50 rounded-xl transition-all">
                    Hủy
                </button>
                <button id="confirmImportBtn" class="px-8 py-3 bg-primary text-white text-sm font-bold rounded-xl hover:bg-primary/90 transition-all">
                    Import dữ liệu
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Bảng danh sách món ăn -->
<section class="bg-white rounded-3xl border border-[#f4ede7] shadow-sm overflow-hidden mb-12">
    <div class="overflow-x-auto">
        <table class="w-full text-left">
            <thead class="bg-[#fcfaf8] text-[#9c7349] text-xs font-bold uppercase tracking-wider">
                <tr>
                    <th class="px-6 py-4">Hình ảnh</th>
                    <th class="px-6 py-4">Mã món</th>
                    <th class="px-6 py-4">Tên món</th>
                    <th class="px-6 py-4">Danh mục</th>
                    <th class="px-6 py-4">Giá bán</th>
                    <th class="px-6 py-4">ĐVT</th>
                    <th class="px-6 py-4 text-center">Tồn kho</th>
                    <th class="px-6 py-4">Trạng thái</th>
                    <th class="px-6 py-4 text-center">Thao tác</th>
                </tr>
            </thead>
            <tbody id="dishesTable" class="divide-y divide-[#f4ede7]"></tbody>
        </table>
    </div>
    <div class="p-6 border-t border-[#f4ede7] flex items-center justify-between">
        <p class="text-sm text-[#9c7349]" id="paginationInfo">Hiển thị 1-8 trong tổng số 48 món ăn</p>
        <div class="flex items-center gap-2">
            <button id="prevPage" class="h-10 w-10 flex items-center justify-center rounded-xl border border-[#f4ede7] text-[#9c7349] hover:bg-gray-50">
                <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <button class="h-10 w-10 flex items-center justify-center rounded-xl bg-primary text-white font-bold">1</button>
            <button class="h-10 w-10 flex items-center justify-center rounded-xl border border-[#f4ede7] text-[#9c7349] hover:bg-gray-50">2</button>
            <button id="nextPage" class="h-10 w-10 flex items-center justify-center rounded-xl border border-[#f4ede7] text-[#9c7349] hover:bg-gray-50">
                <span class="material-symbols-outlined">chevron_right</span>
            </button>
        </div>
    </div>
</section>

<!-- Thống kê nhanh -->
<div class="grid grid-cols-4 gap-6 mb-8">
    <div class="bg-white rounded-3xl border border-[#f4ede7] shadow-sm p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-[#9c7349]">Tổng món ăn</p>
                <p class="text-2xl font-black text-[#1c140d]" id="totalDishes">0</p>
            </div>
            <div class="h-12 w-12 bg-primary/10 rounded-xl flex items-center justify-center">
                <span class="material-symbols-outlined text-primary">restaurant_menu</span>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-3xl border border-[#f4ede7] shadow-sm p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-[#9c7349]">Còn hàng</p>
                <p class="text-2xl font-black text-[#1c140d]" id="inStock">0</p>
            </div>
            <div class="h-12 w-12 bg-green-100 rounded-xl flex items-center justify-center">
                <span class="material-symbols-outlined text-green-600">inventory_2</span>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-3xl border border-[#f4ede7] shadow-sm p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-[#9c7349]">Hết hàng</p>
                <p class="text-2xl font-black text[#1c140d]" id="outStock">0</p>
            </div>
            <div class="h-12 w-12 bg-red-100 rounded-xl flex items-center justify-center">
                <span class="material-symbols-outlined text-red-600">block</span>
            </div>
        </div>
    </div>
    <div class="bg-white rounded-3xl border border-[#f4ede7] shadow-sm p-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-[#9c7349]">Giá trị tồn kho</p>
                <p class="text-2xl font-black text[#1c140d]" id="stockValue">~0tr</p>
            </div>
            <div class="h-12 w-12 bg-purple-100 rounded-xl flex items-center justify-center">
                <span class="material-symbols-outlined text-purple-600">payments</span>
            </div>
        </div>
    </div>
</div>

</main>

<!-- Chatbot (kết hợp từ file gốc) -->
<div class="fixed bottom-6 right-6 z-[100] flex flex-col items-end">
<div class="flex flex-col w-[380px] h-[520px] bg-white rounded-3xl shadow-2xl border border-[#f4ede7] overflow-hidden mb-4 animate-in fade-in slide-in-from-bottom-4 duration-300" id="chatbot-window">
<div class="bg-primary p-4 flex items-center justify-between text-white">
<div class="flex items-center gap-3">
<div class="h-10 w-10 rounded-full bg-white/20 flex items-center justify-center">
<span class="material-symbols-outlined text-white">smart_toy</span>
</div>
<div>
<h3 class="font-bold text-sm">FoodGo AI Assistant</h3>
<div class="flex items-center gap-1.5">
<span class="h-2 w-2 rounded-full bg-green-400"></span>
<span class="text-[10px] opacity-90">Đang trực tuyến</span>
</div>
</div>
</div>
<button class="p-1 hover:bg-white/10 rounded-lg transition-colors">
<span class="material-symbols-outlined">close</span>
</button>
</div>
<div class="flex-1 p-4 overflow-y-auto bg-[#faf9f8] space-y-4 no-scrollbar">
<div class="flex gap-2 max-w-[85%]">
<div class="h-8 w-8 rounded-full bg-primary flex-shrink-0 flex items-center justify-center">
<span class="material-symbols-outlined text-white text-sm">smart_toy</span>
</div>
<div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm border border-[#f4ede7]">
<p class="text-sm text-[#1c140d]">Chào Admin! Tôi có thể giúp gì cho bạn hôm nay?</p>
</div>
</div>
<div class="flex flex-col gap-2 pt-2">
<p class="text-[10px] font-bold text-[#9c7349] uppercase ml-10">Gợi ý cho bạn</p>
<div class="flex flex-wrap gap-2 ml-10">
<button class="px-3 py-1.5 bg-white border border-[#f4ede7] text-xs font-semibold text-primary rounded-full hover:bg-primary/5 hover:border-primary transition-all">
                            Thống kê doanh thu hôm nay
                        </button>
<button class="px-3 py-1.5 bg-white border border[#f4ede7] text-xs font-semibold text-primary rounded-full hover:bg-primary/5 hover:border-primary transition-all">
                            Món nào bán chạy nhất?
                        </button>
<button class="px-3 py-1.5 bg-white border border[#f4ede7] text-xs font-semibold text-primary rounded-full hover:bg-primary/5 hover:border-primary transition-all">
                            Kiểm tra đơn hàng mới
                        </button>
</div>
</div>
</div>
<div class="p-4 bg-white border-t border[#f4ede7]">
<div class="relative flex items-center">
<input class="w-full h-11 pl-4 pr-12 rounded-xl bg-gray-50 border-none text-sm focus:ring-2 focus:ring-primary/20 transition-all" placeholder="Nhập tin nhắn..." type="text"/>
<button class="absolute right-2 h-8 w-8 bg-primary text-white rounded-lg flex items-center justify-center hover:bg-primary/90 transition-colors">
<span class="material-symbols-outlined text-lg">send</span>
</button>
</div>
</div>
</div>
<button class="h-14 w-14 bg-primary text-white rounded-full flex items-center justify-center shadow-xl shadow-primary/30 hover:scale-110 active:scale-95 transition-all duration-300 group" id="chatbot-toggle" tabindex="0">
<span class="material-symbols-outlined text-3xl transition-transform group-focus:rotate-90">smart_toy</span>
</button>
</div>

<script>
// 10 món ăn mẫu (đã chèn đầy đủ, hiển thị ngay khi mở trang)
let dishesData = [
    { id: "#MON-001", name: "Pizza Hải Sản Cao Cấp", category: "Pizza", price: 259000, unit: "Cái", stock: 45, image: "https://via.placeholder.com/300/FF6B6B/FFFFFF?text=Pizza+Hải+Sản", desc: "Pizza hải sản cao cấp với tôm, mực tươi", addedDate: "10/01/2025" },
    { id: "#MON-002", name: "Burger Bò Wagyu", category: "Burger", price: 189000, unit: "Phần", stock: 12, image: "https://via.placeholder.com/300/4ECDC4/FFFFFF?text=Burger+Wagyu", desc: "Burger bò Wagyu thượng hạng", addedDate: "15/01/2025" },
    { id: "#MON-003", name: "Mì Ý Sốt Bò Bằm", category: "Pasta", price: 145000, unit: "Đĩa", stock: 0, image: "https://via.placeholder.com/300/45B7D1/FFFFFF?text=Mì+Ý+Bò+Bằm", desc: "Mì Ý sốt bò bằm truyền thống", addedDate: "20/01/2025" },
    { id: "#MON-004", name: "Trà Sữa Trân Châu Đường Đen", category: "Drink", price: 45000, unit: "Ly", stock: 80, image: "https://via.placeholder.com/300/96CEB4/FFFFFF?text=Trà+Sữa", desc: "Trà sữa trân châu đường đen thơm ngon", addedDate: "05/02/2025" },
    { id: "#MON-005", name: "Bánh Flan Caramel", category: "Dessert", price: 35000, unit: "Phần", stock: 25, image: "https://via.placeholder.com/300/FFEEAD/FFFFFF?text=Bánh+Flan", desc: "Bánh flan caramel mềm mịn", addedDate: "12/02/2025" },
    { id: "#MON-006", name: "Pizza Margherita", category: "Pizza", price: 189000, unit: "Cái", stock: 30, image: "https://via.placeholder.com/300/D4A5A5/FFFFFF?text=Pizza+Margherita", desc: "Pizza Margherita cổ điển", addedDate: "18/02/2025" },
    { id: "#MON-007", name: "Burger Gà Cay", category: "Burger", price: 129000, unit: "Phần", stock: 8, image: "https://via.placeholder.com/300/9B59B6/FFFFFF?text=Burger+Gà+Cay", desc: "Burger gà cay nồng nàn", addedDate: "22/02/2025" },
    { id: "#MON-008", name: "Spaghetti Carbonara", category: "Pasta", price: 165000, unit: "Đĩa", stock: 15, image: "https://via.placeholder.com/300/3498DB/FFFFFF?text=Spaghetti+Carbonara", desc: "Spaghetti sốt kem carbonara", addedDate: "01/03/2025" },
    { id: "#MON-009", name: "Sinh Tố Dâu", category: "Drink", price: 55000, unit: "Ly", stock: 60, image: "https://via.placeholder.com/300/E74C3C/FFFFFF?text=Sinh+Tố+Dâu", desc: "Sinh tố dâu tươi mát", addedDate: "10/03/2025" },
    { id: "#MON-010", name: "Tiramisu Ý", category: "Dessert", price: 65000, unit: "Phần", stock: 20, image: "https://via.placeholder.com/300/F1C40F/FFFFFF?text=Tiramisu", desc: "Tiramisu vị cà phê đậm đà", addedDate: "15/03/2025" }
];

let currentFilter = 'all';
let currentSort = 'newest';
let currentSearch = '';
let currentPage = 1;
const itemsPerPage = 8;
let editingDishId = null;

// DOM elements (giữ nguyên)
const dishesTable = document.getElementById('dishesTable');
const addDishBtn = document.getElementById('addDishBtn');
const dishModal = document.getElementById('dishModal');
const closeDishModal = document.getElementById('closeDishModal');
const cancelDishBtn = document.getElementById('cancelDishBtn');
const dishForm = document.getElementById('dishForm');
const modalTitle = document.getElementById('modalTitle');
const searchInput = document.getElementById('searchInput');
const sortSelect = document.getElementById('sortSelect');
const tabAll = document.getElementById('tabAll');
const tabInStock = document.getElementById('tabInStock');
const tabOutStock = document.getElementById('tabOutStock');
const tabPizza = document.getElementById('tabPizza');
const tabBurger = document.getElementById('tabBurger');
const exportBtn = document.getElementById('exportBtn');
const importBtn = document.getElementById('importBtn');
const detailDishModal = document.getElementById('detailDishModal');
const closeDetailDish = document.getElementById('closeDetailDish');
const paginationInfo = document.getElementById('paginationInfo');
const prevPage = document.getElementById('prevPage');
const nextPage = document.getElementById('nextPage');
const importModal = document.getElementById('importModal');
const closeImportModalBtn = document.getElementById('closeImportModalBtn');
const cancelImportBtn = document.getElementById('cancelImportBtn');
const selectImportFileBtn = document.getElementById('selectImportFileBtn');
const importFileInput = document.getElementById('importFileInput');
const confirmImportBtn = document.getElementById('confirmImportBtn');

// Hiển thị bảng món ăn
function displayDishes(dishes) {
    dishesTable.innerHTML = '';
    const start = (currentPage - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const paginated = dishes.slice(start, end);

    paginated.forEach(dish => {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50/50 transition-colors';
        row.innerHTML = `
            <td class="px-6 py-4"><div class="h-12 w-12 rounded-xl bg-cover bg-center border border-[#f4ede7]" style="background-image: url('${dish.image}')"></div></td>
            <td class="px-6 py-4 text-sm font-bold text-primary">${dish.id}</td>
            <td class="px-6 py-4"><span class="text-sm font-bold text-[#1c140d]">${dish.name}</span></td>
            <td class="px-6 py-4"><span class="px-2.5 py-1 bg-[#f4ede7] text-[#9c7349] text-[10px] font-bold rounded-lg uppercase">${dish.category}</span></td>
            <td class="px-6 py-4 text-sm font-bold text-[#1c140d]">${dish.price.toLocaleString()}đ</td>
            <td class="px-6 py-4 text-sm text-[#9c7349]">${dish.unit}</td>
            <td class="px-6 py-4 text-center"><span class="text-sm font-bold ${dish.stock > 0 ? 'text-[#1c140d]' : 'text-red-500'}">${dish.stock}</span></td>
            <td class="px-6 py-4"><span class="px-3 py-1 ${dish.stock > 0 ? 'status-instock' : 'status-outstock'} text-[10px] font-bold rounded-full uppercase">${dish.stock > 0 ? 'Còn hàng' : 'Hết hàng'}</span></td>
            <td class="px-6 py-4">
                <div class="flex items-center justify-center gap-2">
                    <button onclick="viewDishDetail('${dish.id}')" class="p-2 hover:bg-blue-50 text-blue-600" title="Xem chi tiết"><span class="material-symbols-outlined">visibility</span></button>
                    <button onclick="editDish('${dish.id}')" class="p-2 hover:bg-primary/10 text-primary" title="Chỉnh sửa"><span class="material-symbols-outlined">edit</span></button>
                    <button onclick="deleteDish('${dish.id}')" class="p-2 hover:bg-red-50 text-red-600" title="Xóa"><span class="material-symbols-outlined">delete</span></button>
                </div>
            </td>
        `;
        dishesTable.appendChild(row);
    });

    paginationInfo.textContent = `Hiển thị ${start+1}-${Math.min(end, dishes.length)} trong tổng số ${dishes.length} món ăn`;
    prevPage.disabled = currentPage === 1;
    nextPage.disabled = end >= dishes.length;

    // Cập nhật thống kê
    const total = dishesData.length;
    const inStock = dishesData.filter(d => d.stock > 0).length;
    const outStock = total - inStock;
    const stockValue = dishesData.reduce((sum, d) => sum + d.price * d.stock, 0);
    document.getElementById('totalDishes').textContent = total;
    document.getElementById('inStock').textContent = inStock;
    document.getElementById('outStock').textContent = outStock;
    document.getElementById('stockValue').textContent = `~${(stockValue / 1000000).toFixed(1)}tr`;
}

// Lọc + sắp xếp
function filterAndSortDishes() {
    let filtered = dishesData.filter(d => {
        if (currentFilter === 'instock' && d.stock <= 0) return false;
        if (currentFilter === 'outstock' && d.stock > 0) return false;
        if (currentFilter === 'pizza' && d.category !== 'Pizza') return false;
        if (currentFilter === 'burger' && d.category !== 'Burger') return false;
        if (currentSearch) {
            const s = currentSearch.toLowerCase();
            return d.id.toLowerCase().includes(s) || d.name.toLowerCase().includes(s) || d.category.toLowerCase().includes(s);
        }
        return true;
    });

    filtered.sort((a,b) => {
        switch(currentSort) {
            case 'newest': return new Date(b.addedDate.split('/').reverse().join('-')) - new Date(a.addedDate.split('/').reverse().join('-'));
            case 'oldest': return new Date(a.addedDate.split('/').reverse().join('-')) - new Date(b.addedDate.split('/').reverse().join('-'));
            case 'name_asc': return a.name.localeCompare(b.name);
            case 'name_desc': return b.name.localeCompare(a.name);
            case 'price_asc': return a.price - b.price;
            case 'price_desc': return b.price - a.price;
            case 'stock_desc': return b.stock - a.stock;
            default: return 0;
        }
    });

    return filtered;
}

// Xem chi tiết
window.viewDishDetail = function(id) {
    const dish = dishesData.find(d => d.id === id);
    if (!dish) return;
    document.getElementById('detailDishImage').style.backgroundImage = `url('${dish.image}')`;
    document.getElementById('detailDishName').textContent = dish.name;
    document.getElementById('detailDishCategory').textContent = dish.category;
    document.getElementById('detailDishPrice').textContent = dish.price.toLocaleString() + 'đ';
    document.getElementById('detailDishUnit').textContent = dish.unit;
    document.getElementById('detailDishStock').textContent = dish.stock;
    document.getElementById('detailDishId').textContent = dish.id;
    document.getElementById('detailDishAdded').textContent = dish.addedDate;
    document.getElementById('detailDishDesc').textContent = dish.desc || 'Không có mô tả';
    const statusEl = document.getElementById('detailDishStatus');
    statusEl.textContent = dish.stock > 0 ? 'Còn hàng' : 'Hết hàng';
    statusEl.className = `inline-block px-4 py-1 rounded-full text-sm font-bold ${dish.stock > 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`;
    detailDishModal.classList.remove('hidden');
};

// Chỉnh sửa
window.editDish = function(id) {
    const dish = dishesData.find(d => d.id === id);
    if (!dish) return;
    editingDishId = id;
    modalTitle.textContent = 'Chỉnh sửa món ăn';
    document.getElementById('dishName').value = dish.name;
    document.getElementById('dishPrice').value = dish.price;
    document.getElementById('dishCategory').value = dish.category;
    document.getElementById('dishUnit').value = dish.unit;
    document.getElementById('dishStock').value = dish.stock;
    document.getElementById('dishImage').value = dish.image;
    document.getElementById('dishDesc').value = dish.desc || '';
    dishModal.classList.remove('hidden');
};

// Xóa món
window.deleteDish = function(id) {
    if (!confirm('Xác nhận xóa món ăn này?')) return;
    dishesData = dishesData.filter(d => d.id !== id);
    updateDisplay();
    alert('Đã xóa món ăn thành công!');
};

// Submit form thêm/sửa
dishForm.addEventListener('submit', e => {
    e.preventDefault();
    const data = {
        name: document.getElementById('dishName').value,
        price: parseInt(document.getElementById('dishPrice').value),
        category: document.getElementById('dishCategory').value,
        unit: document.getElementById('dishUnit').value,
        stock: parseInt(document.getElementById('dishStock').value),
        image: document.getElementById('dishImage').value || 'https://via.placeholder.com/300',
        desc: document.getElementById('dishDesc').value
    };
    if (editingDishId) {
        const idx = dishesData.findIndex(d => d.id === editingDishId);
        if (idx !== -1) {
            dishesData[idx] = { ...dishesData[idx], ...data };
            alert('Cập nhật món ăn thành công!');
        }
    } else {
        const newId = `#MON-${String(dishesData.length + 1).padStart(3, '0')}`;
        dishesData.unshift({
            id: newId,
            ...data,
            addedDate: new Date().toLocaleDateString('vi-VN')
        });
        alert('Thêm món ăn mới thành công!');
    }
    dishModal.classList.add('hidden');
    updateDisplay();
});

// Đóng modal
closeDishModal.addEventListener('click', () => dishModal.classList.add('hidden'));
cancelDishBtn.addEventListener('click', () => dishModal.classList.add('hidden'));
closeDetailDish.addEventListener('click', () => detailDishModal.classList.add('hidden'));

// Tìm kiếm & sắp xếp
searchInput.addEventListener('input', e => { currentSearch = e.target.value; currentPage = 1; updateDisplay(); });
sortSelect.addEventListener('change', e => { currentSort = e.target.value; updateDisplay(); });

// Tab
function setActiveTab(btn, filter) {
    [tabAll, tabInStock, tabOutStock, tabPizza, tabBurger].forEach(b => {
        b.classList.remove('tab-active', 'text-primary');
        b.classList.add('text-[#9c7349]', 'border-transparent');
    });
    btn.classList.add('tab-active', 'text-primary');
    currentFilter = filter;
    currentPage = 1;
    updateDisplay();
}
tabAll.addEventListener('click', () => setActiveTab(tabAll, 'all'));
tabInStock.addEventListener('click', () => setActiveTab(tabInStock, 'instock'));
tabOutStock.addEventListener('click', () => setActiveTab(tabOutStock, 'outstock'));
tabPizza.addEventListener('click', () => setActiveTab(tabPizza, 'pizza'));
tabBurger.addEventListener('click', () => setActiveTab(tabBurger, 'burger'));

// Export CSV
exportBtn.addEventListener('click', () => {
    const filtered = filterAndSortDishes();
    let csv = "Mã món,Tên món,Danh mục,Giá,ĐVT,Tồn kho,Trạng thái\n";
    filtered.forEach(d => {
        csv += `${d.id},"${d.name}",${d.category},${d.price},${d.unit},${d.stock},${d.stock > 0 ? 'Còn hàng' : 'Hết hàng'}\n`;
    });
    const uri = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
    const link = document.createElement('a');
    link.href = uri;
    link.download = 'mon_an_foodgo.csv';
    link.click();
});

// Import file JSON cục bộ (đã fix hoàn chỉnh)
confirmImportBtn.addEventListener('click', () => {
    const file = importFileInput.files[0];
    if (!file) {
        alert('Vui lòng chọn file trước!');
        return;
    }

    if (!file.name.endsWith('.json')) {
        alert('Hiện tại chỉ hỗ trợ file .json!');
        return;
    }

    const reader = new FileReader();
    reader.onload = function(event) {
        try {
            const importedData = JSON.parse(event.target.result);

            if (!Array.isArray(importedData)) {
                throw new Error('File phải là mảng JSON (array of objects)');
            }

            const validDishes = importedData.filter(item => {
                return item &&
                    typeof item.name === 'string' && item.name.trim() !== '' &&
                    typeof item.price === 'number' && item.price > 0 &&
                    typeof item.stock === 'number' && item.stock >= 0 &&
                    ['Pizza','Burger','Pasta','Drink','Dessert'].includes(item.category) &&
                    typeof item.unit === 'string' && item.unit.trim() !== '';
            });

            if (validDishes.length === 0) {
                alert('Không tìm thấy món ăn hợp lệ nào trong file!');
                return;
            }

            if (confirm(`Tìm thấy ${validDishes.length} món ăn hợp lệ.\nBạn muốn ghi đè toàn bộ danh sách hiện tại không?`)) {
                dishesData = validDishes.map((item, index) => ({
                    id: item.id || `#MON-${String(dishesData.length + index + 1).padStart(3, '0')}`,
                    name: item.name.trim(),
                    price: item.price,
                    category: item.category,
                    unit: item.unit.trim(),
                    stock: item.stock,
                    image: item.image || 'https://via.placeholder.com/300',
                    desc: item.desc || '',
                    addedDate: item.addedDate || new Date().toLocaleDateString('vi-VN')
                }));

                updateDisplay();
                alert(`Import thành công! Đã cập nhật ${dishesData.length} món ăn.`);
                importModal.classList.add('hidden');
            }
        } catch (err) {
            alert('Lỗi khi đọc file: ' + err.message + '\nVui lòng kiểm tra định dạng JSON!');
        }
    };

    reader.readAsText(file);
});

// Mở modal Import
importBtn.addEventListener('click', () => {
    importModal.classList.remove('hidden');
    importFileInput.value = '';
    selectImportFileBtn.innerHTML = 'Chọn file';
    selectImportFileBtn.classList.remove('bg-green-100', 'text-green-700', 'border-green-300');
});

// Đóng modal Import
closeImportModalBtn.addEventListener('click', () => importModal.classList.add('hidden'));
cancelImportBtn.addEventListener('click', () => importModal.classList.add('hidden'));

// Chọn file → đổi tên nút
selectImportFileBtn.addEventListener('click', () => importFileInput.click());

importFileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        const fileName = e.target.files[0].name;
        selectImportFileBtn.innerHTML = `<span class="material-symbols-outlined text-xl mr-2">check_circle</span> ${fileName}`;
        selectImportFileBtn.classList.add('bg-green-100', 'text-green-700', 'border-green-300');
    }
});

// Phân trang
prevPage.addEventListener('click', () => { if (currentPage > 1) { currentPage--; updateDisplay(); } });
nextPage.addEventListener('click', () => {
    const filtered = filterAndSortDishes();
    if (currentPage * itemsPerPage < filtered.length) { currentPage++; updateDisplay(); }
});

// Cập nhật giao diện
function updateDisplay() {
    const filtered = filterAndSortDishes();
    displayDishes(filtered);
}

// Khởi tạo
addDishBtn.addEventListener('click', () => {
    editingDishId = null;
    modalTitle.textContent = 'Thêm món ăn mới';
    dishForm.reset();
    dishModal.classList.remove('hidden');
});

updateDisplay(); // Hiển thị 10 món mẫu ngay lập tức
</script>
</body>
</html>
